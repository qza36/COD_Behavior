<?xml version="1.0" encoding="UTF-8"?>
<root BTCPP_format="4">
  <BehaviorTree ID="t2">
    <Sequence>
      <SendNav2Goal goal_pose="${qs_goal_psition}"/>
      <RetryUntilSuccessful num_attempts="-1">
        <CheckNavResult/>
      </RetryUntilSuccessful>
      <attack_qs/>
      <KeepRunningUntilFailure>
        <Fallback>
          <Sequence>
            <is_lowhp hp="200"/>
            <SendNav2Goal goal_pose="${home_goal_position}"/>
          </Sequence>
          <Sequence>
            <is_lowhp hp="300"/>
            <movearound/>
          </Sequence>
          <Sequence>
            <check_allow_shut_num allow_shut_num="20"/>
            <SendNav2Goal goal_pose="home"/>
            <RetryUntilSuccessful num_attempts="-1">
              <CheckNavResult/>
            </RetryUntilSuccessful>
            <buy_shut/>
          </Sequence>
          <Sequence>
            <is_qs_hp_low qs_hp="200"/>
            <SendNav2Goal goal_pose="${qs_goal_psition}"/>
          </Sequence>
          <KeepRunningUntilFailure>
            <Sequence>
              <qsbroke/>
              <Fallback>
                <SendNav2Goal goal_pose="${baolei_goal_position}"/>
                <AlwaysSuccess/>
              </Fallback>
            </Sequence>
          </KeepRunningUntilFailure>
          <KeepRunningUntilFailure>
            <Sequence>
              <lowpower/>
              <Fallback>
                <Sequence>
                  <is_lowhp hp=""/>
                  <SendNav2Goal goal_pose="home"/>
                </Sequence>
                <Sequence>
                  <check_allow_shut_num allow_shut_num=""/>
                  <SendNav2Goal goal_pose="home"/>
                </Sequence>
                <AlwaysSuccess/>
              </Fallback>
            </Sequence>
          </KeepRunningUntilFailure>
          <AlwaysSuccess/>
        </Fallback>
      </KeepRunningUntilFailure>
    </Sequence>
  </BehaviorTree>

  <!-- Description of Node Models (used by Groot) -->
  <TreeNodesModel>
    <Action ID="CheckNavResult"
            editable="true"/>
    <Action ID="SendNav2Goal"
            editable="true">
      <input_port name="goal_pose"/>
    </Action>
    <Action ID="attack_qs"
            editable="true"/>
    <Action ID="buy_shut"
            editable="true"/>
    <Action ID="check_allow_shut_num"
            editable="true">
      <input_port name="allow_shut_num"/>
    </Action>
    <Action ID="is_lowhp"
            editable="true">
      <input_port name="hp"/>
    </Action>
    <Action ID="is_qs_hp_low"
            editable="true">
      <input_port name="qs_hp"/>
    </Action>
    <Action ID="lowpower"
            editable="true"/>
    <Action ID="movearound"
            editable="true"/>
    <Action ID="qsbroke"
            editable="true"/>
  </TreeNodesModel>

</root>
